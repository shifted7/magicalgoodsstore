## Vulnerability Report
**Vulnerability 1: Identity**  
Our application implements Identity Framework that provides secure logins by using password hashes as well as providing individual salting per user.  
A vulnerable code block might look like this:  
```
public static int CustomHash(string key)
{
    //some hash function we created 
    return badHash;
}
```
To identify that an application is using Identity would be to check the start up page and look for the following snippet code within the `ConfigureServices()` method.

```
 services.AddIdentity<ApplicationUser, IdentityRole>()
         .AddEntityFrameworkStores<ApplicationDbContext>()
         .AddDefaultTokenProviders();
``` 
  
**Vulnerability 2: Error Handling** 
Without proper error handling, an attacker can perform reconnaissance on our site to gather information about the application servers, frameworks, and libraries we are using. This helps the attacker plan future attacks.  
Improper error handling might look like this:
```
// inside configure method, developer exception page is always shown.
app.UseDeveloperExceptionPage();
```

We have provided a separate controller whose purpose is to implement error handling. When there is an error, it will return an error handling message as a JSON object instead of a 500 error. 
```
if(env.IsDevelopment())
{
    app.UseDeveloperExceptionPage();
}
else
{
    app.UseExceptionHandler("/api/error");
}
```

**Vulnerability 3: Tag Helpers**  
Without using tag helpers, an attacker can submit forms/send data to incorrect pages. Without them, your code would look like this:  
```
//this a tag with an empty href can be changed to submit to any page on our site.
<a href="">Click Here To Submit</a>
```
Tag Helpers help to automatically generate and verify antiforgery tokens. To implement Tag Helpers, you would add:  
```@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers```  
into your `_ViewImports.cshtml` file.
```
//this would be the proper implementation 
<a asp-action="submit"> Click here to Submit </a>
```


**Vulnerability 4: Data Access**  
We are using Enitity Framework instead of using our own SQL queries and this prevents SQL injection. 
Without Entity Framework, the following input could be submitted directly into our database.  
```
// attack can simply get all user data for themselves.
SELECT * FROM Users
```
With Entity Framework, we use map data to our models and use built-in methods.  
```
_applicationUsers.FindAsync(userId);
```

### Resource:
[.NET OWASP Top 10](https://cheatsheetseries.owasp.org/cheatsheets/DotNet_Security_Cheat_Sheet.html)


